<!doctype html>
<html lang="en">
  <!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1135930111808538');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=1135930111808538&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>OverEdge â€” Free Picks</title>
  <meta name="description" content="Transparent football picks with clear confidence and reasoning."/>
  <link rel="stylesheet" href="/style.css"/>

  <!-- Favicons / icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/overedge-logo-512.png">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-88C4MQ3EF8"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-88C4MQ3EF8');
  </script>

  <style>
    .lead { font-size: clamp(1.1rem, 1.7vw, 1.2rem); opacity:.8; margin-top:.25rem; }
    .muted-sm{opacity:.7;font-size:.95rem}
  </style>
</head>
<script defer src="/_vercel/speed-insights/script.js"></script>
<script>
  (function(){
    try{
      const u=new URL(location.href); const c=u.searchParams.get('fbclid');
      if(c) document.cookie="fbclid="+encodeURIComponent(c)+"; Max-Age="+60*60*24*90+"; Path=/; SameSite=Lax";
    }catch{}
  })();
</script>
<script src="/pixel.js" defer></script>
<script src="/social.js" defer></script>

<body>
  <header class="site-header">
    <nav class="nav">
      <a class="logo brand" href="/" aria-label="OverEdge">
        <img class="brand-img" src="/img/overedge-logo.png" alt="" />
        <span class="sr-only">OverEdge</span>
      </a>

      <div class="links">
        <a href="/free-picks">Free Picks</a>
        <a href="/pro">Pro</a>
        <a href="/pricing">Pricing</a>
        <a href="/FAQ">FAQ</a>
        <a href="/results">Results</a>
        <a href="/account">Account</a>
      </div>
      <div class="auth" style="display:flex;align-items:center;gap:.5rem">
        <span id="nav-plan" class="badge pill" style="display:none"></span>
        <button id="nav-auth" class="btn small secondary" type="button">Sign In</button>
      </div>
    </nav>
  </header>

  <main class="section" style="max-width:900px">
    <h1>Todayâ€™s Free Picks (preview)</h1>
    <p class="lead">Two highest-confidence O/U 2.5 selections, with confidence %, odds (when available), and a quick reasoning line.</p>
    <div id="home-free-picks" class="lead">Loadingâ€¦</div>
    <p><a class="btn" href="/free-picks">View full details â†’</a></p>
  </main>

  <!-- Unified footer with trust badges, bigger social buttons, and cookie link -->
  <footer class="site-footer">
    <span>Â© <span id="y"></span> OverEdge â€” Data beats gut</span>

    <div class="trust">
      <span class="tb"><i class="icon">ðŸ’³</i> Secured by Stripe</span>
      <span class="tb"><i class="icon">ðŸ‡ªðŸ‡º</i> GDPR Compliant</span>
      <span class="tb"><i class="icon">ðŸ”’</i> 256-bit SSL</span>
    </div>

    <!-- Bigger FB/IG buttons (using existing .btn styles) -->
    <div class="footer-social" style="display:flex;gap:.5rem;justify-content:center;margin:.6rem 0;">
      <a class="btn" href="https://www.facebook.com/overedgefootball" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:.5rem;">
        <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18" aria-hidden="true"><path d="M22 12.07C22 6.48 17.52 2 11.93 2S2 6.48 2 12.07c0 5.02 3.66 9.19 8.44 9.93v-7.02H7.9v-2.9h2.54V9.41c0-2.5 1.5-3.88 3.79-3.88 1.1 0 2.25.2 2.25.2v2.47h-1.27c-1.25 0-1.64.78-1.64 1.58v1.9h2.79l-.45 2.9h-2.34V22c4.78-.74 8.44-4.91 8.44-9.93z"/></svg>
        <span>Facebook</span>
      </a>
      <a class="btn secondary" href="https://www.instagram.com/overedgefootball" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:.5rem;">
        <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18" aria-hidden="true"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7Zm5 3.5A5.5 5.5 0 1 1 6.5 13 5.5 5.5 0 0 1 12 7.5Zm0 2A3.5 3.5 0 1 0 15.5 13 3.5 3.5 0 0 0 12 9.5Zm5.75-3.25a.75.75 0 1 1-.75.75.75.75 0 0 1 .75-.75Z"/></svg>
        <span>Instagram</span>
      </a>
    </div>

    <a href="#" class="cookie-link" onclick="oeConsent.revoke();return false;">Cookie settings</a>

    <div class="contact" style="margin-top:.5rem">
      <a href="mailto:overedgestats@gmail.com">overedgestats@gmail.com</a>
      &nbsp;Â·&nbsp;
      <a href="https://www.facebook.com/overedgefootball" target="_blank" rel="noopener">Facebook</a>
      &nbsp;Â·&nbsp;
      <a href="https://www.instagram.com/overedgefootball" target="_blank" rel="noopener">@overedgefootball</a>
    </div>
  </footer>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    function tzGuess(){
      try { return Intl.DateTimeFormat().resolvedOptions().timeZone || "Europe/Sofia"; }
      catch { return "Europe/Sofia"; }
    }

   function reasonSnippet(html){
  if (!html) return "";
  // convert <br> to spaces, strip tags, grab first sentence
  const txt = html
    .replace(/<br\s*\/?>/gi, " ")
    .replace(/<\/?[^>]+>/g, ""); // strip all tags

  const first = (txt.split(/[.?!]\s/)[0] || "").trim().replace(/\.$/, "");
  return first ? first + "." : "";
}

    function pickPreviewCard(p){
      const league = [p.country, p.league].filter(Boolean).join(" â€” ");
      const odds = (p.odds && !isNaN(Number(p.odds))) ? `<span class="badge odds" style="margin-left:.4rem">Odds ${Number(p.odds).toFixed(2)}</span>` : "";
      const snippet = reasonSnippet(p.reasoning || "");
      return `
        <div class="card" style="margin:.75rem 0;padding:1rem;border-radius:12px">
          <div style="font-weight:700">${league}</div>
          <div class="muted" style="margin:.15rem 0 .35rem">${p.matchTime} â€” <strong>${p.home}</strong> vs <strong>${p.away}</strong></div>
          <div style="display:flex;align-items:center;gap:.5rem;flex-wrap:wrap">
            <strong>${p.market}</strong>
            <span class="badge pill conf">Confidence ${p.confidencePct}%</span>
            ${odds}
          </div>
          ${snippet ? `<div class="muted-sm" style="margin-top:.45rem">${snippet}</div>` : ""}
        </div>
      `;
    }

    async function loadPreview() {
      const el = document.getElementById('home-free-picks');
      if (!el) return;
      el.textContent = 'Loadingâ€¦';
      try {
        const res = await fetch(`/api/rpc?action=free-picks&tz=${encodeURIComponent(tzGuess())}&minConf=75`);
        const data = await res.json();
        const picks = Array.isArray(data?.picks) ? data.picks : [];
        if (!picks.length) {
          el.innerHTML = '<p class="lead">No confident picks available yet today.</p>';
          return;
        }
        el.innerHTML = picks.map(pickPreviewCard).join('');
      } catch (e) {
        el.innerHTML = '<p class="lead">Could not load picks.</p>';
      }
    }

    document.addEventListener('DOMContentLoaded', loadPreview);
  </script>

  <!-- Cookie settings shim so the footer link always works -->
  <script>
    window.oeConsent = window.oeConsent || {};
    if (typeof window.oeConsent.revoke !== 'function') {
      window.oeConsent.revoke = function(){ alert('Cookie settings coming soon.'); };
    }
  </script>

  <!-- Shared navbar auth module -->
  <script type="module" src="/auth.js"></script>
</body>
</html>
